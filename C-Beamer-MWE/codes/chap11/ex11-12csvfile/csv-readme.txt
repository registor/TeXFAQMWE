CSV (逗号分隔值文件格式)

逗号分隔值(Comma-Separated Values,CSV,有时也称为字符分隔值,因为分隔字符也可以不是逗号),其文件以纯文本形式存储表格数据(数字和文本)。纯文本意味着该文件是一个字符序列,不含必须像二进制数字那样被解读的数据。CSV文件由任意数目的记录组成,记录间以某种换行符分隔;每条记录由字段组成,字段间的分隔符是其它字符或字符串,最常见的是逗号或制表符。通常,所有记录都有完全相同的字段序列。通常都是纯文本文件。

CSV文件格式的通用标准并不存在,但是在RFC 4180中有基础性的描述。使用的字符编码同样没有被指定,但是7-bitASCII是最基本的通用编码。


一、用法
CSV是一种通用的、相对简单的文件格式，被用户、商业和科学广泛应用。最广泛的应用是在程序之间转移表格数据，而这些程序本身是在不兼容的格式上进行操作的(往往是私有的和/或无规范的格式）。因为大量程序都支持某种CSV变体，至少是作为一种可选择的输入/输出格式。

例如，一个用户可能需要交换信息，从一个以私有格式存储数据的数据库程序，到一个数据格式完全不同的电子表格。最可能的情况是，该数据库程序可以导出数据为“CSV”，然后被导出的CSV文件可以被电子表格程序导入。

“CSV”并不是一种单一的、定义明确的格式(尽管RFC 4180有一个被通常使用的定义）。因此在实践中，术语“CSV”泛指具有以下特征的任何文件：
1、纯文本，使用某个字符集，比如ASCII、Unicode、EBCDIC或GB2312；
2、由记录组成(典型的是每行一条记录）；
3、每条记录被分隔符分隔为字段(典型分隔符有逗号、分号或制表符；有时分隔符可以包括可选的空格）；
4、每条记录都有同样的字段序列。

在这些常规的约束条件下，存在着许多CSV变体，故CSV文件并不完全互通。然而，这些变异非常小，并且有许多应用程序允许用户预览文件(这是可行的，因为它是纯文本），然后指定分隔符、转义规则等。如果一个特定CSV文件的变异过大，超出了特定接收程序的支持范围，那么可行的做法往往是人工检查并编辑文件，或通过简单的程序来修复问题。因此在实践中，CSV文件还是非常方便的。

二、规则
1、开头是不留空，以行为单位。
2、可含或不含列名，含列名则居文件第一行。
3、一行数据不跨行，无空行。
4、以半角逗号(即,）作分隔符，列为空也要表达其存在。
5、列内容如存在半角引号(即"），替换成半角双引号(""）转义，并用半角引号(即""）将该字段值包含起来。
6、文件读写时引号，逗号操作规则互逆。
7、内码格式不限，可为 ASCII、Unicode 或者其他。
8、不支持特殊字符

三、规范
CSV没有通用标准规范。不同的程序间CSV的标准有差异很常见，这可能导致交互操作困难。
1、基本规则
CSV格式是用分隔符分隔的数据格式，常用逗号分隔字段/列，用换行符分隔记录/行。当字段/列中包含有逗号，换行符，或双引号这些特殊字符时，必须用双引号将该字段括住。当行内包含一个空字符串字段时，也可以用双引号将其括起来。当字段中包含双引号时，需要用两个双引号(双引号转义符）。

CSV文件格式并不需要特定的字符编码、字节顺序或行终止格式。

每个记录由一个换行符(ASCII码=0X0A)或回车换行符(ASCII码=0X0D 0X0A)结束。

字段间用逗号分隔(当字段中包含逗号时，也可以用分号作为分隔符，例如地址中会常用逗号：1997,Ford,E350）

当各字段内的嵌入逗号时，则必须存将该字段置于一对双引号内。

当各字段内的嵌入式双引号字符时，则必须将该字段置于一对双引号内，且该双引号需要用一对紧临的双引号进行转义。

当各字段内的嵌入换行符时，则必须将该字段置于一对双引号内。

当各字段的有前导或尾随空格时，则必须将该字段置于一对双引号内。

第一条记录可能包含每个字段的列名。

2、举例说明

年	制造商	型号					说明					价值
1997	Ford 	E350					ac, abs, moon				3000.00
1999	Chevy 	Venture "Extended Edition"							4900.00
1999	Chevy 	Venture "Extended Edition, Very Large"						5000.00
1996	Jeep	Grand Cherokee				MUST SELL! air,				4799.00
							    moon roof, loaded

上面表格内容若可以用CSV格式表示为：

年,制造商,型号,说明,价值
1997,Ford,E350,"ac, abs, moon",3000.00
1999,Chevy,"Venture ""Extended Edition""","",4900.00
1999,Chevy,"Venture ""Extended Edition, Very Large""","",5000.00
1996,Jeep,Grand Cherokee,"MUST SELL! air, 
                              moon roof, loaded",4799.00

该例说明:
（1）包含有逗号、双引号或是换行符的字段必须置于一对双引号内。
（2）字段内部的双引号必须在其前面增加一个双引号来实现转义。
（3）分隔符逗号前后的空格有可能不会删除。
（4）字段中的换行符将被保留。 
